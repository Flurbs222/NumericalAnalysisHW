\documentclass[12pt]{article}
\usepackage{Environments}
\usepackage{Packages}
\usepackage{amsmath}

\title{Numerical Analysis HW10}
\author{Coyne, Dedvukaj, Gao, Karabushin, Lin, Morales}
\date{\today}

\setlength{\headheight}{15pt}

\begin{document}
\pagestyle{fancy}

\fancyhead[L]{Coyne, Dedvukaj, Gao, Karabushin, Lin, Morales}
\fancyhead[R]{Josh Morales}

\begin{center}
\textbf{\Large Homework 10} \\
\text{Due date}: April 24th, 2025
\end{center}

\begin{enumerate}[leftmargin=0em]
    %Problem 1
    \item
    We have matrix A as 
    \[\begin{bmatrix}
        3 & 1 & 0 \\
        1 & 4 & 2 \\
        0 & 2 & 3
    \end{bmatrix} \].

    We want to find $Q$ and $R$ through the Gram-Schmidt process.

    First we can start with $a_1$ as 

    \[ \begin{bmatrix}
        3 \\
        1 \\ 
        10
    \end{bmatrix}
    \]. And compute the norm

    \[ ||a_1|| = \sqrt{(3^{2} + 1^{2}+0^{2})} = \sqrt{10}\].
    We can then normalize $a_1$ to get the first column of our matrix $Q$
    \[ q_1 = \frac{1}{\sqrt{10}} \begin{bmatrix}
        3 \\
        1\\
        10
    \end{bmatrix} = \begin{bmatrix}
        \frac{3}{\sqrt{10}} \\
        \frac{1}{\sqrt{10}} \\
        0
    \end{bmatrix}\]. 

    We can then repeat this process for \[a_2 = \begin{bmatrix}
        1 \\
        4 \\
        2
    \end{bmatrix}\] However, in order to make $a_2$ orthogonal to $q_1$, we have to subtract the projection of $a_2$ onto $q_1$. 
    \[ \proj_{q1}(a_2) = (a_2 \cdot q_1)q_1.
        \]
        First we can compute
        \[ a_2 \cdot q_1 = (1 \times \frac{3}{\sqrt{10}} + 4 \times \frac{1}{\sqrt{10}} + 2 \times 0) = \frac{3+4}{\sqrt{10}} = \frac{7}{\sqrt{10}}\]

        Now, we can compute the projection
        \[\proj_{q_1}(a_2) = \frac{7}{\sqrt{10}} \begin{bmatrix}
            \frac{3}{\sqrt{10}} \\
            \frac{1}{\sqrt{10}} \\
            0
        \end{bmatrix} = 
        \begin{bmatrix}
            \frac{21}{10} \\
            \frac{7}{10} \\
            0
        \end{bmatrix}\]
     And now we can subtract the projection from $a_2$ to get $u_2$. 

     \[
        u_{2} = \begin{bmatrix}
            1 \\
            4 \\
            2
        \end{bmatrix} - \begin{bmatrix}
            \frac{21}{10} \\
            \frac{7}{10} \\
            0
        \end{bmatrix} = \begin{bmatrix}
            \frac{21}{10} \\
            \frac{7}{10} \\
            9
        \end{bmatrix}\]. 

        We now must normalize $u_2$ to get \[
            ||u_2|| = \sqrt{\frac{-11}{10}^{2} + \frac{33}{10}^{2} + 2^2} = \sqrt{\frac{121}{100} + \frac{1089}{100}  + 4} = 
            \sqrt{\frac{1610}{100}} = \frac{\sqrt{1610}}{10}.
        \]
        Then, we can normalize $u_2$ to get 
        \[q_2 = \frac{10}{\sqrt{1610}} \begin{bmatrix}
            \frac{-11}{10} \\
            \frac{33}{10} \\
            2
        \end{bmatrix} = \begin{bmatrix}
            \frac{-11}{\sqrt{1610}} \\
            \frac{33}{\sqrt{1610}} \\
            \frac{21}{\sqrt{1610}}
        \end{bmatrix}\].

        We can take the third column of A  and repeat.
        \[ a_3 \cdot q_1 = 0 \times \frac{3}{\sqrt{10}} + 2 \frac{1}{\sqrt{10}} + 3 \times 0 = \frac{2}{\sqrt{10}}\]
        \[\proj_{q_1}(a_3)=\frac{2}{\sqrt{10}} \begin{bmatrix}
            \frac{3}{\sqrt(10)} \\
            \frac{1}{\sqrt{10}} \\
            0
        \end{bmatrix} = \begin{bmatrix}
            \frac{6}{10} \\
            \frac{2}{10} \\
            0
        \end{bmatrix} =   \begin{bmatrix}
            \frac{3}{5} \\
            \frac{1}{5} \\
            0
        \end{bmatrix} \]
        \[
            q_2 = \begin{bmatrix}
                \frac{-11}{\sqrt{1610}} \\
                \frac{33}{\sqrt{1610}} \\
                \frac{20}{\sqrt{1610}}
            \end{bmatrix}\]

        \[a_3 \cdot q_2 = 0 \times \frac{-11}{\sqrt{1610}} + 2 \times \frac{33}{\sqrt{1610}} + 3 \times \frac{20}{\sqrt{1610}} = \frac{126}{\sqrt{1610}}\].
        \[\proj_{q_2}(a_3) = \frac{126}{\sqrt{1610}} = \begin{bmatrix}
            \frac{-11}{\sqrt{1610}} \\
            \frac{33}{\sqrt{1610}} \\
            \frac{20}{\sqrt{1610}}
        \end{bmatrix} = \begin{bmatrix}
            \frac{-1386}{1610} \\
            \frac{4158}{1610} \\
            \frac{2520}{1610}
        \end{bmatrix} = \begin{bmatrix}
            \frac{-693}{805} \\
            \frac{2079}{805} \\
            \frac{1260}{805}
        \end{bmatrix}\] 
        \[u_3 = \begin{bmatrix}
            0 \\
            2 \\
            3 
        \end{bmatrix} - \begin{bmatrix}
            \frac{3}{5} \\
            \frac{1}{5} \\
            0
        \end{bmatrix} - \begin{bmatrix}
            \frac{-693}{805} \\
            \frac{2079}{805} \\
            \frac{1260}{805}
        \end{bmatrix}\] so \[u_3 = 
        \begin{bmatrix}
            \frac{210}{805} \\
            \frac{-1934}{805} \\
            \frac{1155}{805}
        \end{bmatrix}\].

        \[||u_3|| = \frac{210^2+621^2+1155^2}{805^2} = \frac{44100 + 385641 + 1334025}{805^2} = \frac{1768766}{805^2}\]
        \[||u_3|| = \frac{\sqrt{1768766}}{805}\]
        \[q_3 = \begin{bmatrix}
            \frac{210}{\sqrt{1768766}} \\
            \frac{-621}{\sqrt{1768766}} \\
            \frac{1155}{\sqrt{1768766}}
        \end{bmatrix}\].

        So \[Q = \begin{bmatrix}
            \frac{3}{\sqrt{10}} & \frac{-11}{\sqrt{1610}} & \frac{210}{\sqrt{1768766}} \\
            \frac{1}{\sqrt{10}} & \frac{33}{\sqrt{1610}} & \frac{-621}{\sqrt{1768766}} \\
            0 & \frac{20}{\sqrt{1610}} & \frac{1155}{\sqrt{1768766}}
        \end{bmatrix}\]

        \[ R = \begin{bmatrix}
            \sqrt{10} & \frac{7}{\sqrt{10}} & \frac{2}{\sqrt{10}} \\
            0 & \frac{\sqrt{1610}}{10} & \frac{126}{\sqrt{1610}} \\
            0 & 0 & \frac{\sqrt{1768766}}{805}
        \end{bmatrix}\]

        So we can now finally get $A^{(2)}$
        \[A^{(2)} = RQ = \begin{bmatrix}
            3 & 1 & 0 \\
            1 & 4 & 2 \\ 
            0 & 2 & 3
        \end{bmatrix}\]. 

        And since $A^{(2)} = A$, and $A$ is a symmetric matrix, QR-iteration does not alter the matrix. So, $A^{3} = A^{2} = A$.
    %Problem 2
    \item
    \begin{enumerate}[leftmargin=!]
        %2a
        \item
        \(A^{(1)} = Q^{(1)}R^{(1)}\). To find $Q^{(1)}$:
        
        \[v_{1}=\left[\begin{matrix}0\\ 1\end{matrix}\right]\
        ||v_{1}||=\sqrt{0^{2}+1^{2}}=1, 
        q_{1}=\frac{v_{1}}{||v_{1}||}=\left[\begin{matrix}0\\ 1\end{matrix}\right], 
        v_{2}=\left[\begin{matrix}1\\ 0\end{matrix}\right]\]
        \[v_{2}^{\prime }=v_{2}-(v_{2}\cdot q_{1})q_{1}=
        \left[\begin{matrix}1\\ 0\end{matrix}\right]-(\left[\begin{matrix}1\\ 0\end{matrix}\right]\cdot
        \left[\begin{matrix}0\\ 1\end{matrix}\right])
        \left[\begin{matrix}0\\ 1\end{matrix}\right]=
        \left[\begin{matrix}1\\ 0\end{matrix}\right]-0
        \left[\begin{matrix}0\\ 1\end{matrix}\right]=
        \left[\begin{matrix}1\\ 0\end{matrix}\right]\]
        \[||v_{2}^{\prime }||=\sqrt{1^{2}+0^{2}}=1, 
        v_{2}=\frac{v_{2}^{\prime }}{||v_{2}^{\prime }||}=\left[\begin{matrix}1\\ 0\end{matrix}\right]\]
        \[Q^{(1)}=\left[\begin{matrix}0&1\\ 1&0\end{matrix}\right]\]

        \[R^{(1)} = Q^{T}A = \left[\begin{matrix}0&1\\ 1&0\end{matrix}\right]\left[\begin{matrix}0&1\\ 1&0\end{matrix}\right]=\left[\begin{matrix}1&0\\ 0&1\end{matrix}\right]\]

        \[A^{(2)} = R^{(1)}Q^{(1)} = \left[\begin{matrix}1&0\\ 0&1\end{matrix}\right]\left[\begin{matrix}0&1\\ 1&0\end{matrix}\right] = \left[\begin{matrix}0&1\\ 1&0\end{matrix}\right]\]

        Since \(A^{(2)}=A\), the QR decomposition for $A^{(3)}$ will be the same as for $A^{(2)}$. So
        \[A^{(3)} = \left[\begin{matrix}0&1\\ 1&0\end{matrix}\right]\]
        \(A^{(2)}\) and \(A^{(3)}\) are both equal to the original matrix \(A\).
        
        %2b
        \item
        In this case, the QR method does not calculate a diagonalization of $A$ because the eigenvalues of $A$ have the same magnitude. The characteristic polynomial is given by \(det(A-\lambda I)\), where \(I\) is the identity matrix.
        \[det(A-\lambda I)=det\left(\begin{matrix}-\lambda &1\\ 1&-\lambda \end{matrix}\right)=(-\lambda )(-\lambda )-(1)(1)=\lambda ^{2}-1\]
        so $\lambda$ is either $1$ or $-1$. Since the magnitudes of the eigenvalues are non-distinct, A does not converge to a diagonal matrix.

        %2c
        \item
        See part (b).

    \end{enumerate}
    
    %Problem 3
    \item

    %Problem 4
    \item
    Note that
    \[A^{t} = VS^{t}U^{t}.\]
    Since $U$ and $V$ are orthogonal, it suffices to show that the entries of $S$ are the singular values of $A^{t}$. Since ${[S^{t}]}_{ij} = S_{ji} = 0$ whenever $i\neq j$, we can see that the entries of $S^{t}$ are $0$ everywhere except the main diagonal, where ${[S^{t}]}_{ii} = S_{ii}$ for all $i$. Therefore, 
    it suffices to show that the singular values\footnote{Note that the values are already decreasing by assumption that $USV^{t}$ is a singular value decomposition.} of $A^{t}$ are equal to the singular values of $A$. The singular values of $A^{t}$ are given by the square root of the eigenvalues of ${(A^{t})}^{t}A^{t} = {(A^{t}A)}^{t}$. However, we note that for any square matrix $B$, we have that the eigenvalues of $B$ are equal to the eigenvalues of $B^{t}$. Therefore, the eigenvalues of ${(A^{t}A)}^{t}$ are equal to the eigenvalues of
    $A^{t}A$, which are precisely the square of the singular values of $A$. Therefore, the singular values of $A$ and $A^{t}$ are equal, and thus, $A^{t} = VS^{t}U^{t}$ is a singular value decomposition of $A^{t}$, which is the desired result.

    %Problem 5
    \item 
    \[y' = \frac{t}{y^2}, y(0) = 1\]
    \[y^2y' = t\]
    \[y^2dy = tdt\]
    \[\int y^2dy = \int tdt\]
    \[y^3 = \frac{3}{2}t^2 + C\]
    Since $y(0) = 1, 1^3 = \frac{3}{2} + 0 + C$, so $C = 1$, so $y^3 = \frac{3}{2}t^3+1$, then $y = (\frac{3}{2}t^{3}+1)^{\frac{1}{3}}$

    %Problem 6
    \item
    \begin{enumerate}[leftmargin=!]
        %6a
        \item 
        Note that for all $y_1,y_2\in [c,d]$ and $t\in [a,b]$, we have that
        \[|f(t,y_1)-f(t,y_2)| = |ty_{1}-ty_{2}| = |t||y_{1}-y_{2}|\leq b|y_{1}-y_{2}|.\]
        Therefore, $f$ satisfies the Lipschitz condition.

        %6b
        \item
        Separating variables, we see that
        \[\int\frac{1}{y}\, dy\, = \int t\, dt\, \implies \ln(y) = \frac{t^2}{2}+c \implies y = e^{\frac{t^2}{2}+c} = Ce^{\frac{t^2}{2}}\]
        for some constant $C$. Evaluating our initial condition gives
        \[3=y(0) = e^{\frac{0}{2}}C=C.\]
        Therefore, $y(t) = 3e^{\frac{t^2}{2}}$.

        %6c
        \item
        As before, the general solution to $y'_{\varepsilon} = ty_{\varepsilon}$ is given by $y_{\varepsilon}(t) = Ce^{\frac{t^2}{2}}$ for some constant $C$. Evaluating at the initial condition gives
        \[3+\varepsilon = C.\]
        Therefore, $y_{\varepsilon}(t) = (3+\varepsilon)e^{\frac{t^2}{2}}$. Note that
        \[\lim_{t \to \infty} |y(t)-y_{\varepsilon}(t)| = \lim_{t\to \infty} \left|3e^{\frac{t^2}{2}}-(3+\varepsilon)e^{\frac{t^2}{2}}\right| = \lim_{t\to \infty} \left|\varepsilon\right|e^{\frac{t^2}{2}}= \infty.\]
        Despite being a slight perturbation of the original solution, the error can still grow quite large out for large values of $t$. 
    \end{enumerate}
\end{enumerate}
\end{document}
