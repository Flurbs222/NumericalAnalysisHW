\documentclass[12pt]{article}
\usepackage{Environments}
\usepackage{Packages}

\title{Numerical Analysis HW9}
\author{Coyne, Dedvukaj, Gao, Karabushin, Lin, Morales}
\date{\today}

\setlength{\headheight}{15pt}

\begin{document}
\pagestyle{fancy}

\fancyhead[L]{Coyne, Dedvukaj, Gao, Karabushin, Lin, Morales}
\fancyhead[R]{Josh Morales}

\begin{center}
\textbf{\Large Homework 9} \\
\text{Due date}: April 9th, 2025
\end{center}

\begin{enumerate}[leftmargin=0em]
    %Problem 1
    \item
    Since $\{w_1,w_2,\dots,w_k\}$ is an orthonormal basis for $W$, we can represent $w$ using
    $a = \begin{bmatrix}
           a_1 \\
           a_2 \\
           \vdots \\
           a_k
         \end{bmatrix}
         \in \mathbb{R}^k$.

    \[
    w = a_1w_1+\dots + a_kw_k = Aa
    \]
    $w$ is the orthogonal projection of $v$ onto $W$ $\iff$ $v-w$ is orthogonal to all vectors in $W$. Specifically it must be orthogonal to each basis vector, meaning for every $j=1,2,\dots,k$
    \[
    \langle v-w \; , \; w_j \rangle = 0
    \]
    Since the matrix $A$ has the basis vectors as columns, we can say that
    \[
    A^T(v-w)_j = \langle w_j \; , \; v-w \rangle
    \]
    And since all inner products are zero, this is equivalent to
    \[
    A^T(v-w)=0
    \]
    Using our previous representation of $w$, this can be rewritten as
    \[
    A^T(v-Aa) = 0
    \]
    \[
    = A^Tv-A^TAa = 0
    \]
    And because the columns of $A$ form an orthonormal set, $A^TA=I_k$, we get
    \[
    A^Tv-I_ka =A^Tv-a = 0
    \]
    \[
    a = A^Tv
    \]
    So going back to the previous representation of $w$,
    \[
    w = Aa = A(A^Tv) = AA^Tv
    \]
    Thus this vector $w$ is the closest approximation of $v$.

    %Problem 2
    \item  
    First we note that for all $0\leq k \leq n$, we have that 
    \[\left\langle \frac{1}{\sqrt{2}},\cos(kx)\right\rangle=\frac{1}{\pi}\int_{-\pi}^{\pi}\frac{1}{\sqrt{2}} \cos(kx)\, dx\, = \frac{1}{\pi}\left[\frac{\sin(kx)}{k}\right]\bigg\rvert_{-\pi}^{\pi}=0\]
    where we used the fact that $\sin(k\pi) =0$ for all integers $k$.

    \smallskip


    \noindent Furthermore, note that
    \[\left\langle \frac{1}{\sqrt{2}},\sin(kx)\right\rangle=\frac{1}{\pi}\int_{-\pi}^{\pi}\frac{1}{\sqrt{2}} \sin(kx)\, dx\, = 0\]
    since $\sin(kx)$ is an odd function for all integers $k$. 
    
    \smallskip

    \noindent Next, note that 
    \[\left\langle \frac{1}{\sqrt{2}},\frac{1}{\sqrt{2}}\right\rangle=\frac{1}{\pi}\int_{-\pi}^{\pi}\frac{1}{2}\, dx\, = \frac{1}{\pi}\frac{2\pi}{2} =1.\]

    \bigskip

    \noindent Now for all positive integers $m$ and $n$, we first note that $\cos(mx)\sin(nx)$ is an odd function, so they will have an inner product of $0$. Considering $\cos(nx)$ and $\cos(mx)$, we have two cases. If $n=m$, we have that
    \[\left\langle \cos(mx), \cos(mx) \right\rangle=\frac{1}{\pi}\int_{-\pi}^{\pi}\cos^2(mx)\, dx\, = \frac{1}{\pi}\int_{0}^{\pi}\left(1+\cos(2mx)\right)\, dx\, =\frac{1}{\pi}\left(x+\frac{1}{2m}\sin(2mx)\right)\bigg\rvert_{0}^{\pi}\]
    \[=\frac{1}{\pi}\pi = 1.\]
    If $n\neq m$, then we have
    \[\left\langle \cos(nx), \cos(mx) \right\rangle=\frac{2}{\pi}\int_{0}^{\pi}\cos(nx)\cos(mx)\, dx\, = \frac{1}{\pi}\int_{0}^{\pi} \left(\cos((n-m)x)+\cos((n+m)x)\right)\, dx\,\]
    \[=\frac{1}{\pi}\left(\frac{1}{n-m}\sin((n-m)x)+\frac{1}{n+m}\sin((n+m)x)\right)\bigg\rvert_{0}^{\pi} = 0 \]
    where we once again used that $\sin(k\pi)=0$. 

    \smallskip

    \noindent We finally consider $\sin(nx)$ and $\sin(mx)$, which once again has two cases. If $n=m$, then
    \[\left\langle \sin(mx), \sin(mx) \right\rangle=\frac{2}{\pi}\int_{0}^{\pi}\sin^2(mx)\, dx\, = \frac{1}{\pi}\int_{0}^{\pi}\left(1-\cos(2mx)\right)\, dx\, =\frac{1}{\pi}\left(x-\frac{1}{2m}\sin(2mx)\right)\bigg\rvert_{0}^{\pi}\]
    \[=\frac{1}{\pi}\pi = 1.\]
    If $n\neq m$, then we have
    \[\left\langle \sin(nx), \sin(mx) \right\rangle=\frac{2}{\pi}\int_{0}^{\pi}\sin(nx)\sin(mx)\, dx\, = \frac{1}{\pi}\int_{0}^{\pi} \left(\cos((n-m)x)-\cos((n+m)x)\right)\, dx\,\]
    \[=\frac{1}{\pi}\left(\frac{1}{n-m}\sin((n-m)x)-\frac{1}{n+m}\sin((n+m)x)\right)\bigg\rvert_{0}^{\pi} = 0 \]
    by the same reasons as above. Therefore, the set is an orthonormal set, which is the desired result. 

    %Problem 3
    \item
    \begin{enumerate}[leftmargin=!]
        %3a
        \item
        We seek the continuous Fourier approximation \( S_3(x) \) of the function \( f(x) = e^x \) on the interval \( [-\pi, \pi] \), using the formula:
        \[S_n(x) = \left\langle f(x), 1 \right\rangle \cdot \frac{1}{2} + \sum_{k=1}^{n} \left( \left\langle f(x), \sin(kx) \right\rangle \cdot \sin(kx) + \left\langle f(x), \cos(kx) \right\rangle \cdot \cos(kx) \right)\]
        with the inner product defined as:
        \[\langle f(x), g(x) \rangle = \frac{1}{\pi} \int_{-\pi}^{\pi} f(x) g(x) \, dx\]

        \[a_0 = \langle f(x), 1 \rangle = \frac{1}{\pi} \int_{-\pi}^{\pi} e^x \, dx = \frac{1}{\pi} (e^{\pi} - e^{\pi})\]
        \[\Rightarrow \frac{a_0}{2} = \frac{1}{2\pi}(e^{\pi} - e^{-\pi})\]

        \[a_1 = \frac{1}{\pi} \int_{-\pi}^{\pi} e^x \cos(x) \, dx = \frac{1}{\pi} \left[ \frac{e^x}{2} (\sin(x) +\cos(x)) \right]_{-\pi}^{\pi}\]
        \[= \frac{1}{\pi} \left( -\frac{e^{\pi}}{2} + \frac{e^{-\pi}}{2} \right) = -\frac{1}{2\pi}(e^{\pi} - e^{-\pi})\]

        \[b_1 = \frac{1}{\pi} \int_{-\pi}^{\pi} e^x \sin(x) \, dx = \frac{1}{\pi} \left[ \frac{e^x}{2} (\sin(x) - \cos(x)) \right]_{-\pi}^{\pi}\]
        \[= \frac{1}{\pi} \left( \frac{e^{\pi}}{2} - \frac{e^{-\pi}}{2} \right) = \frac{1}{2\pi}(e^{\pi} - e^{-\pi})\]

        Using:
        \[\int e^x \cos(ax) dx = \frac{e^x (a \sin(ax) + \cos(ax))}{a^2 + 1}, \quad\int e^x \sin(ax) dx = \frac{e^x (\sin(ax) - a \cos(ax))}{a^2 + 1}\]
        We get:
        \[a_2 = \frac{1}{\pi} \left[ \frac{e^x (2 \sin(2x) + \cos(2x))}{5} \right]_{-\pi}^{\pi}= \frac{1}{5\pi}(e^{\pi} - e^{-\pi})\]
        \[b_2 = \frac{1}{\pi} \left[ \frac{e^x (\sin(2x) - 2 \cos(2x))}{5} \right]_{-\pi}^{\pi}= -\frac{2}{5\pi}(e^{\pi} - e^{-\pi})\]

        \[a_3 = \frac{1}{\pi} \left[ \frac{e^x (3 \sin(3x) + \cos(3x))}{10} \right]_{-\pi}^{\pi}= -\frac{1}{10\pi}(e^{\pi} - e^{-\pi})\]
        \[b_3 = \frac{1}{\pi} \left[ \frac{e^x (\sin(3x) - 3 \cos(3x))}{10} \right]_{-\pi}^{\pi}= \frac{3}{10\pi}(e^{\pi} - e^{-\pi})\]

        Evaluating numerically, we have:
        \[S_3(x) \approx 3.6767 - 3.6767\cos(x) + 3.6767\sin(x) + 1.4707\cos(2x) - 2.9414\sin(2x) - 0.7353\cos(3x) + 2.2060\sin(3x)\]

        %3b
        \item
        We must calculate \(\langle y,\phi _{k}\rangle \) and \(\langle y,\psi _{k}\rangle \) for \(k=0,1,2,3\) 
        First, calculate \(\langle y,\phi _{0}\rangle \),
        \[\langle y,\phi _{k}\rangle =\frac{1}{10}\sum _{j=0}^{19}y_{j}\cos (kx_{j})\]
        \(\langle y,\phi _{1}\rangle \), \(\langle y,\phi _{2}\rangle \), and \(\langle y,\phi _{3}\rangle \).
        \[\langle y,\phi _{0}\rangle =\frac{1}{10}\sum _{j=0}^{19}y_{j}\cos (0)=\frac{1}{10}\sum _{j=0}^{19}y_{j}\]
        \[\langle y,\phi _{1}\rangle =\frac{1}{10}\sum _{j=0}^{19}y_{j}\cos (x_{j})\]
        \[\langle y,\phi _{2}\rangle =\frac{1}{10}\sum _{j=0}^{19}y_{j}\cos (2x_{j})\]
        \[\langle y,\phi _{3}\rangle =\frac{1}{10}\sum _{j=0}^{19}y_{j}\cos (3x_{j})\]

        Next, calculate \(\langle y,\psi _{k}\rangle \) for \(k=1,2,3\)
        \[\langle y,\psi _{k}\rangle =\frac{1}{10}\sum _{j=0}^{19}y_{j}\sin (kx_{j})\]
        \[\langle y,\psi _{1}\rangle =\frac{1}{10}\sum _{j=0}^{19}y_{j}\sin (x_{j})\]
        \[\langle y,\psi _{2}\rangle =\frac{1}{10}\sum _{j=0}^{19}y_{j}\sin (2x_{j})\]
        \[\langle y,\psi _{3}\rangle =\frac{1}{10}\sum _{j=0}^{19}y_{j}\sin (3x_{j})\]

        \[S_{3}(x)=\frac{1}{2}\langle y,\phi _{0}\rangle +\sum _{k=1}^{3}(\langle y,\phi _{k}\rangle \cos (kx))+\sum _{k=1}^{3}(\langle y,\psi _{k}\rangle \sin (kx))\]
        \[S_{3}(x)=\frac{1}{2}\langle y,\phi _{0}\rangle +\langle y,\phi _{1}\rangle \cos (x)+\langle y,\phi _{2}\rangle \cos (2x)+\langle y,\phi _{3}\rangle \cos (3x)+\langle y,\psi _{1}\rangle \sin (x)+\langle y,\psi _{2}\rangle \sin (2x)+\langle y,\psi _{3}\rangle \sin (3x)\]
        
        \[S_{3}(x)\approx 3.676+2.963\cos (x)+0.946\cos (2x)+0.164\cos (3x)-1.263\sin (x)-0.740\sin (2x)-0.214\sin (3x)\]
        
    \end{enumerate} 

    %Problem 4
    \item
    \begin{enumerate}[leftmargin=!]
        %4a
        \item Q is orthogonal.
        \[ Q^{t}Q=1\]
        \[\det(Q^tQ) = 1\]
        \[\det(Q^t)\det(Q)=1\]
        Since $\det(Q^t) = \det(Q)$,
        \[\det(Q)^2 = 1\]
        \[\det(Q)\pm 1\]
        %4b
        \item
        \[(PQ)^tPQ = Q^tP^tPQ = Q^t(I)Q = Q^tQ=I\].
        So $PQ$ is orthogonal.
    \end{enumerate}

    %Problem 5
    \item
    \begin{enumerate}[leftmargin=!]
        %5a
        \item 
        Note that since $\det(P^{-1}) = \det(P)^{-1}$, we have that
        \[\det(B) = \det(P^{-1}AP) = \det(P^{-1})\det(A)\det(P) = \det(A)\det(P)\det(P)^{-1} = \det(A).\]
        %5b
        \item 
        It suffices to show that $A$ and $B$ have the same characteristic polynomial. Indeed, we have that 
        \[\det(B-\lambda I) = \det(P^{-1}AP -\lambda P^{-1}P) = \det(P^{-1}AP - P^{-1}(\lambda P)) = \det(P^{-1}(A-\lambda I)P) = \det(A-\lambda I).\]
        %5c
        \item
        Since $A$ is invertible, then $\det(B) = \det(A) \neq 0$. Therefore, $B$ is also invertible. Furthermore, we have that
        \[B^{-1} = {(P^{-1}AP)}^{-1} = P^{-1} A^{-1} {(P^{-1})}^{-1} = P^{-1} A^{-1} P.\]
        Therefore, $A^{-1}$ and $B^{-1}$ are similar, which is the desired result.

    \end{enumerate}

    %Problem 6
    \item We are given the symmetric matrix:

    \[
    A = \begin{bmatrix}
    1 & -1 & 2 \\
    -1 & 1 & 2 \\
    2 & 2 & 2
    \end{bmatrix}
    \]
    
    We want to decompose it as:
    
    \[
    A = Q D Q^T
    \]
    
    To find the eigenvalues, we solve the characteristic polynomial:
    
    \[\det(A - \lambda I) \]
    
    \[ A - \lambda I = \begin{bmatrix}
    1 & -1 & 2 \\
    -1 & 1 & 2 \\
    2 & 2 & 2
    \end{bmatrix}
    -
    \begin{bmatrix}
        \lambda & 0 & 0 \\
        0 & \lambda & 0 \\
        0 & 0 & \lambda
    \end{bmatrix}
    \]
    \[
    = \begin{bmatrix}
        1 - \lambda & -1 & 2 \\
        -1 & 1-\lambda & 2 \\
        2 & 2 & 2-\lambda
    \end{bmatrix}
    \]
    We know can find the determinant of the matrix:
    
    \[(1-\lambda)
    \begin{bmatrix}
    1-\lambda & 2 \\
    2 & 2-\lambda
    \end{bmatrix}
    -(-1)
    \begin{bmatrix}
        -1 & 2 \\
        2 & 2-\lambda
    \end{bmatrix}
    +2 \begin{bmatrix}
        -1 & 1-\lambda \\
        2 & 2
    \end{bmatrix} 
    = 
    -\lambda^{3} + 4\lambda^{2}+4\lambda-16 = -(\lambda - 4)(\lambda - 2)(\lambda + 2)
    \]
    
    The eigenvalues are:
    \[
    \lambda_1 = 4, \quad \lambda_2 = 2, \quad \lambda_3 = -2
    \]
    Solve \( (A - 4I)\vec{v} = 0 \), we get:
    \[
    \vec{v}_1 = \begin{bmatrix} 1 \\ 1 \\ 2 \end{bmatrix}, \quad
    \|\vec{v}_1\| = \sqrt{6}
    \Rightarrow
    q_1 = \frac{1}{\sqrt{6}} \begin{bmatrix} 1 \\ 1 \\ 2 \end{bmatrix}
    \]
    
    Solve \( (A - 2I)\vec{v} = 0 \), we get:
    \[
    \vec{v}_2 = \begin{bmatrix} 1 \\ -1 \\ 0 \end{bmatrix}, \quad
    \|\vec{v}_2\| = \sqrt{2}
    \Rightarrow
    q_2 = \frac{1}{\sqrt{2}} \begin{bmatrix} 1 \\ -1 \\ 0 \end{bmatrix}
    \]
    
    Solve \( (A + 2I)\vec{v} = 0 \), we get:
    \[
    \vec{v}_3 = \begin{bmatrix} 1 \\ 1 \\ -1 \end{bmatrix}, \quad
    \|\vec{v}_3\| = \sqrt{3}
    \Rightarrow
    q_3 = \frac{1}{\sqrt{3}} \begin{bmatrix} 1 \\ 1 \\ -1 \end{bmatrix}
    \]
    
    Orthogonal matrix \( Q \) (columns are the normalized eigenvectors):
    
    \[
    Q =
    \begin{bmatrix}
    \frac{1}{\sqrt{6}} & \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{3}} \\
    \frac{1}{\sqrt{6}} & -\frac{1}{\sqrt{2}} & \frac{1}{\sqrt{3}} \\
    \frac{2}{\sqrt{6}} & 0 & -\frac{1}{\sqrt{3}}
    \end{bmatrix}
    \]
    
    Diagonal matrix \( D \) of eigenvalues:
    
    \[
    D = \begin{bmatrix}
    4 & 0 & 0 \\
    0 & 2 & 0 \\
    0 & 0 & -2
    \end{bmatrix}
    \]
    
\end{enumerate}
\end{document}
