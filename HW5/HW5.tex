\documentclass[12pt]{article}
\usepackage{Environments}
\usepackage{Packages}
\title{}
\author{Josh Morales}
\date{\today}
\setlength{\headheight}{15pt}
\begin{document}
\pagestyle{fancy}
\fancyhead[L]{Numerical Analysis HW 5}
\fancyhead[R]{Coyne, Dedvukaj, Gao, Karabushin, Lin, Morales}
\begin{center}
\textbf{\Large Homework } \\
\text{Due date}: \today
\end{center}
\begin{enumerate}[leftmargin=2em]
    %Question 1
    \item Let $f (x) = 3xe^x - cos x$. By using the forward-difference formula, the three-point
    midpoint formula, and the five-point midpoint formula with $h = 0.1, 0.05,
    0.01$, compute approximations of $f'(1.3)$.\\
    \\For $x_0=1.3$, the function at the values modified by $h$ are as follows.
    \[
    \begin{array}{|c|c|c|c|}
    \hline
    h & \text{Rule} & x & f(x) \\
    \hline
    0.1  & x_0 - h  & 1.2  & 11.5901  \\
         & x_0 + h  & 1.4  & 16.8619  \\
         & x_0 - 2h & 1.1  & 9.4602   \\
         & x_0 + 2h & 1.5  & 20.0969  \\
    \hline
    0.05 & x_0 - h  & 1.25 & 12.7735  \\
         & x_0 + h  & 1.35 & 15.4036  \\
         & x_0 - 2h & 1.2  & 11.5901  \\
         & x_0 + 2h & 1.4  & 16.8619  \\
    \hline
    0.01 & x_0 - h  & 1.29 & 13.7818  \\
         & x_0 + h  & 1.31 & 14.3074  \\
         & x_0 - 2h & 1.28 & 13.5244  \\
         & x_0 + 2h & 1.32 & 14.5758  \\
    \hline
    \end{array}
    \]
    
    \subsection*{Forward Difference}
    \[
    f'(x_0) = \frac{1}{h}(f(x_0+h)-f(x_0)) + O(h)
    \]
    For $h = 0.1$
    \[
    f'(1.3) = \frac{1}{0.1}(f(1.4)-f(1.3)) = \frac{16.8619-14.0427}{0.1} = 28.191
    \]
    For $h = 0.05$
    \[
    f'(1.3) = \frac{1}{0.05}(f(1.35)-f(1.3)) = \frac{15.4036-14.0427}{0.05} = 27.216
    \]
    For $h=0.01$
    \[
    f'(1.3) = \frac{1}{0.01}(f(1.31)-f(1.3)) = \frac{14.3074-14.0427}{0.01} = 26.47
    \]
    \subsection*{3 point midpoint}
    \[
    f'(x_0) = \frac{1}{2h}(f(x_0+h)-f(x_0-h)) + O(h^2)
    \]
    For $h = 0.1$
    \[
    f'(1.3) = \frac{1}{2(0.1)}(16.8619-11.5901) = 26.359
    \]
    For $h = 0.05$
    \[
    f'(1.3) = \frac{1}{2(0.05)}(15.4036-12.7735) = 26.301
    \]
    For $h = 0.01$
    \[
    f'(1.3) = \frac{1}{2(0.01)}(14.3074-13.7818) = 26.28
    \]
    \subsection*{5 point midpoint}
    \[
    f'(x_0) = \frac{1}{12h}(f(x_0-2h)-8f(x_0-h)+8f(x_0+h)-f(x_0+2h)) + O(h^4)
    \]
    For $h = 0.1$
    \[
    f'(1.3) = \frac{1}{12(0.1)}((9.4602)-8(11.5901)+8(16.8619)-20.0969) = 26.2814
    \]
    For $h = 0.05$
    \[
    f'(1.3) = \frac{1}{12(0.05)}((11.5901)-8(12.7735)+8(15.4036)-(16.8619)) = 26.2817 %66
    \]
    For $h = 0.01$
    \[
    f'(1.3) = \frac{1}{12(0.01)}((13.5244)-8(13.7818)+8(14.3074)-(14.5758)) = 26.2783 %BIG rounding error, should converge to 26.2817
    \]

    %Question 2
    \item 

    %Question 3
    \item We can differentiate $y=x^{3}$ as follows:
    \[ f'(x) = \frac{d}{dx}x^{3} = 3x^{2}\].
    Thus the integrand becomes 
    \[\sqrt{1+(3x^{2})^{2}} = \sqrt{1+9x^{4}}\].
    So using Simpson's rule, we need to evaluate 
    \[L = \int_{0}^{1}\sqrt{1+9x^{4}}dx\].
    We can approximate the integral as follows:
    \[\int_{a}^{b}f(x)dx \approx \frac{h}{3}[f(x_0)+4f(x_1)+2f(x_2)+4f(x_3)+2f(x_4)+4f(x_5)+f(x_6)]\]
    where $h = \frac{b-a}{n}$ and $x_i = a+ih$.
    For $n=6$, $a=0$, and $b=1$,
    \[h=\frac{1-0}{6} = \frac{1}{6}\]
    The nodes are
    \[x_0 = 0, \quad x_1 = \frac{1}{6}, \quad x_2 = \frac{2}{6}, \quad x_3 = \frac{3}{6}, \quad x_4 = \frac{4}{6}, \quad x_5 = \frac{5}{6}, \quad x_6 = 1.\]
    So we can evaluate $f(x) = \sqrt{1+9x^4}$ at these points:
    \[f(0) = \sqrt{1 + 9(0)^4} = \sqrt{1} = 1.\]
    \[f\left(\frac{1}{6}\right) = \sqrt{1 + 9\left(\frac{1}{6}\right)^4} = \sqrt{1.00694} \approx 1.00347\]
    \[f\left(\frac{2}{6}\right) = \sqrt{1 + 9\left(\frac{2}{6}\right)^4} = \sqrt{1.05556} \approx 1.02747\]
    \[f\left(\frac{3}{6}\right) = \sqrt{1 + 9\left(\frac{3}{6}\right)^4} = \sqrt{1.5625} = 1.25\]
    \[f\left(\frac{4}{6}\right) = \sqrt{1 + 9\left(\frac{4}{6}\right)^4} = \sqrt{1.7778} \approx 1.3333\]
    \[f\left(\frac{5}{6}\right) = \sqrt{1 + 9\left(\frac{5}{6}\right)^4} = \sqrt{2.3403} \approx 1.53\]
    \[f(1) = \sqrt{1 + 9(1)^4} = \sqrt{10} \approx 3.1623\]
    We can then use the Simpson's rule formula
    \[L \approx \frac{h}{3} \left[ f(0) + 4f\left(\frac{1}{6}\right) + 2f\left(\frac{2}{6}\right) + 4f\left(\frac{3}{6}\right) + 2f\left(\frac{4}{6}\right) + 4f\left(\frac{5}{6}\right) + f(1) \right]\]
    And substitute values to get the following:
    \[L \approx \frac{1}{18} \left[ 1 + 4(1.00347) + 2(1.02747) + 4(1.25) + 2(1.3333) + 4(1.53) + 3.1623 \right]\]
    \[L \approx \frac{1}{18} \left[ 1 + 4.0139 + 2.0549 + 5 + 2.6667 + 6.12 + 3.1623 \right]\]
    \[L \approx \frac{1}{18} \times 24.0178\]
    \[L \approx 1.3343\]


    %Question 4
    \item 

    %Question 5
    \item
    \begin{enumerate}[leftmargin=!]
        %5a
        \item 
        \begin{proof}
            By the extreme value theorem. $f$ has a maximum and minimum on $[a,b]$. Therefore, there exists $x_{\min},x_{\max}\in [a,b]$ such that
            $f(x_{\min})= \min\limits_{a\leq x\leq b} f(x)$ and $f(x\max)= \max\limits_{a\leq x\leq b} f(x)$. Furthermore, by definition of the maximum and minimum, we have
            \[f(x_{\min}) = \frac{nf(x_{\min})}{n} = \frac{\sum\limits_{i=1}^{n} f(x_{\min})}{n} \leq \frac{\sum\limits_{i=1}^{n} f(x_{i})}{n} \leq \frac{\sum\limits_{i=1}^{n} f(x_{\max})}{n}= f(x_{\max}).\]
            Therefore, by the intermediate value theorem, there exists an $c \in [x_{\min},x_{\max}]\subseteq [a,b]$ such that 
            \[f(c)= \frac{\sum\limits_{i=1}^{n} f(x_{i})}{n}\]
            which is the desired result.
        \end{proof}

        %5b
        \item 
        \begin{theorem}[Integral Mean Value Theorem for $g(x)=1$]\label{thm:intMVT} Let $f$ be a continuous function on $[a,b]$. Then there exists a $c\in [a.b]$ such that
            \[f(c)(b-a)=\int_{a}^{b}f(x)dx.\]
        \end{theorem}
        \begin{lemma}\label{lem:nonnegativeint}
            Let $f$ be a Riemann integrable function on $[a,b]$, such that 
            \[f(x)\geq 0\]
            for all $x\in [a,b]$. Then
            \[\int_{a}^{b}f(x)dx \geq 0.\]
        \end{lemma}
        \begin{proof}[Proof of Lemma~\ref{lem:nonnegativeint}]
            Let $P=\{a=x_0,x_1,\ldots,x_n=b\}$ be an arbitrary  partition of $[a,b]$. Since $f(x)\geq 0$ on $[a,b]$, we have that
            \[U(f,P) := \sum_{i=1}^{n} (x_i-x_{i-1})M_i \geq 0\]
            and
            \[L(f,P):= \sum_{i=1}^{n} (x_i-x_{i-1})m_i \geq 0\]
            where $M_i:= \sup\limits_{x\in [x_{i-1},x_i]} f(x)$ and $M_i:= \inf\limits_{x\in [x_{i-1},x_i]} f(x)$. Therefore, since $P$ was arbitrary, we must have that
            \[\overline{\int_{a}^{b}} f(x)dx := \inf\{U(f,P)\, |\, P \text{ is a partition of } [a,b]\} \geq 0.\]
            Since $f$ is Riemann integrable, we finally have that
            \[\int_{a}^{b} f(x)dx = \overline{\int_{a}^{b}} f(x)dx\geq 0\]
            which is the desired result.
        \end{proof}
        \begin{lemma}\label{lem:intcomparison}
            Let $f$ and $g$ be Riemann integrable functions on $[a,b]$ such that for all $x\in [a,b]$,
            \[f(x)\geq g(x).\]
            Then
            \[\int_{a}^{b} f(x)dx\geq \int_{a}^{b} g(x)dx\]
        \end{lemma}
        \begin{proof}[Proof of Lemma~\ref{lem:intcomparison}]
            Consider $h(x):= f(x)-g(x)$. Since $f$ and $g$ are Riemann integrable on $[a,b]$, $h$ is also Riemann integrable on $[a,b]$. Furthermore, since 
            $f(x)\geq g(x)$ for all $x\in [a,b]$,
            \[h(x)\geq 0\]
            for all $x\in [a,b]$. Therefore, by Lemma~\ref{lem:nonnegativeint} and the additivity of the Riemann integral, we have that
            \[\int_{a}^{b}f(x)dx - \int_{a}^{b} g(x)dx \geq 0.\]
            Adding $\int_{a}^{b}g(x)dx$ to both sides completes the proof.
        \end{proof}
        \begin{lemma}\label{lem:corollarytocomparison}
            Let $f$ and $g$ be Riemann integrable functions on $[a,b]$ such that for all $x\in [a,b]$,
            \[f(x)\leq g(x).\]
            Then
            \[\int_{a}^{b} f(x)dx\leq \int_{a}^{b} g(x)dx\]
        \end{lemma}
        \begin{proof}[Proof of Lemma~\ref{lem:corollarytocomparison}]
            Since $f(x)\leq g(x)$ on $[a,b]$, then $-f(x)\geq -g(x)$ on $[a,b]$. Furthermore, since $f$ and $g$ are both Riemann integrable, then $-f$ and $-g$ are also both Riemann integrable. Therefore, by Lemma~\ref{lem:intcomparison} and the linearity of the integral, we have
            \[-\int_{a}^{b}f(x)dx \geq -\int_{a}^{b}g(x)dx.\]
            Multiplying by $-1$ completes the proof.
        \end{proof}
        \newpage
        \begin{lemma}\label{lem:comparisontheorem}
            Let $f$ be a continuous function\footnote{Continuous on $[a,b]$ also implies Riemann integrable on $[a,b]$.} on $[a,b]$. Let\footnote{These values exist by the extreme value theorem.} $m=\min_{a\leq x\leq b} f(x)$ and $M=\max_{a\leq x\leq b}f(x)$. 
            Then
            \[m(b-a)\leq \int_{a}^{b} f(x)dx \leq M(b-a).\]
        \end{lemma}
        \begin{proof}[Proof of Lemma~\ref{lem:comparisontheorem}]
            Since $m\leq f(x)\leq M$ for all $x\in [a,b]$. By Lemma~\ref{lem:intcomparison}, Lemma~\ref{lem:corollarytocomparison}, and properties of the Riemann integral, we have that
            \[m(b-a)=\int_{a}^{b} m dx \leq  \int_{a}^{b} f(x) dx \leq \int_{a}^{b} M dx = M(b-a) \]
            which was the desired result.
        \end{proof}
        \begin{proof}[Proof of Theorem~\ref{thm:intMVT}]
            Since $f$ is continuous on $[a,b]$, $f$ attains a maximum and minimum on $[a,b]$, say $M$ and $m$ respectively. Then by Lemma~\ref{lem:comparisontheorem}, we have that
            \[m(b-a)\leq \int_{a}^{b} f(x) dx\leq M(b-a)\]
            which implies that
            \[m\leq \frac{1}{b-a} \int_{a}^{b} f(x) dx \leq M.\]
            Therefore, by the Intermediate Value Theorem, there exists\footnote{Technically $c\in [x_{\min},x_{\max}]$ where $f(x_{\min})=m$ and $f(x_{\max})= M$. However, we will skip over that detail as $[x_{\min},x_{\max}]\subseteq [a,b]$.} a $c\in [a,b]$ such that
            \[f(x)=\frac{1}{b-a}\int_{a}^{b}f(x)dx.\]
            Multiplying by $(b-a)$ gives the desired result.
        \end{proof}
    \end{enumerate}
    
    %Question 6
    \item 
    \begin{enumerate}[leftmargin=!]
        %6a
        \item We must show that the Simpson Rule $S_2$ has no error for polynomials $1, x, x^{2}, x^{3}$ over a given interval. Consider the third-degree polynomial \( f(x) = ax^3 + bx^2 + cx + d \) integrated using Simpson's rule over the interval [-1, 1].
        \[\int_{1}^{-1}f(x)dx \approx \frac{h}{3}[f(x_0)+4f(x_1)+f(x_2)]\]
        where $h = \frac{1-(-1)}{3}$.

        %6b
        \item

        %6c
        \item
    \end{enumerate}
\end{enumerate}
\end{document}
